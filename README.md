# mdview

ターミナルで Markdown を読みやすく表示するための高速 CLI ビューアです。Bubble Tea と Glamour をベースに、青を基調としたカスタムテーマと Vim ライクなキーバインドを備えています。

---

## 特長

- **Markdown レンダリング**: Goldmark → Glamour で整形。見出し階層は配色で統一感を保ち、コードは濃紺背景で強調。
- **2 ペイン構成**: 左にファイルツリー、右に本文ビュー。端末サイズに追従してリフローします。
- **Vim ライク操作**: `j/k`, `Ctrl+d/u`, `gg/G` などお馴染みのキーでスクロール。`Ctrl+h/l` でツリーと本文のフォーカスを切り替え。
- **ヘルプオーバーレイ**: `?` を押すと画面中央に主要キーバインドをポップアップ表示。
- **Markdown ツリー探索**: `.md` / `.markdown` のみを再帰列挙し、不要ディレクトリ（`.git`, `node_modules` など）は自動スキップ。

---

## 使い方

```bash
mdview <path>
```

- `<path>` がファイルの場合: 指定ファイルを即座に本文ペインへ表示します。
- `<path>` がディレクトリの場合: ツリーにフォーカスした状態で起動します。ファイルを選択するまで本文ペインは空のままです。

### ツリーでファイルを開く
1. `gg`, `G`, `j`, `k` でカーソル移動。
2. `l` または `Enter` でディレクトリを展開／ファイルを表示。
3. `h` でディレクトリを閉じます。
4. `Ctrl+l` で本文ペインへ戻り、同じキーバインドでスクロールできます。

---

## キーバインド一覧

| 分類 | キー | 説明 |
| --- | --- | --- |
| 共通 | `q`, `Ctrl+c` | 終了 |
| 共通 | `Ctrl+h`, `Ctrl+l` | ツリーと本文のフォーカス切替 |
| 共通 | `t` | ツリーペインの表示 / 非表示切替 |
| 共通 | `?` | ヘルプオーバーレイを表示 / 閉じる |
| ツリー | `j`, `k` | カーソル上下移動 |
| ツリー | `l`, `Enter` | ディレクトリを開く / ファイルを表示 |
| ツリー | `h` | ディレクトリを閉じる |
| ツリー | `gg`, `G` | ツリーの先頭 / 末尾へ移動 |
| 本文 | `j`, `k` | 1 行スクロール |
| 本文 | `Ctrl+d`, `Ctrl+u` | 半ページスクロール |
| 本文 | `h`, `l` | 横スクロール |
| 本文 | `gg`, `G` | 先頭 / 末尾へジャンプ |

---

## アーキテクチャ覚書

- **UI**: Bubble Tea + Bubbles(viewport) + Lip Gloss。Alt Screen で動作し、ファイルツリーは独自レンダリング。
- **Markdown**: Goldmark を Glamour でレンダリング。カスタムテーマは `cmd/mdview/main.go` の `customStyle` で定義。
- **状態管理**: `contentVP` / `treeVP` の 2 つのビューポート、`pendingKey` による Vim 風キーシーケンス、`treeRoot` を用いた再帰ツリー構造。
- **ファイル探索**: `filepath.WalkDir` で `.md`, `.markdown` のみを列挙し、`shouldSkipDir` で不要ディレクトリを除外。

---

## 今後のロードマップ候補

- ツリーからのマルチペイン表示（タブ・分割）。
- `gx` などリンク操作、検索操作 (`/`, `n/N`) の追加。
- 自動リロード、TOC 抽出ジャンプ、テーマ切替の実装。
- 画像埋め込み表示（pixterm / sixel 等）への対応。
